<html>
  <head>
    <!-- Load plotly.js into the DOM -->
    <script src='https://cdn.plot.ly/plotly-2.4.2.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js'></script>
	  
    <!-- gstatic chart loader -->
    <script src="https://www.gstatic.com/charts/loader.js"></script>  
    <script>
d3.csv('https://raw.githubusercontent.com/plotly/datasets/master/api_docs/mt_bruno_elevation.csv', function(err, rows){
function unpack(rows, key) {
  return rows.map(function(row) { return row[key]; });
}

var z_data=[ ]
for(i=0;i<24;i++)
{
  z_data.push(unpack(rows,i));
}

var data = [{
           z: z_data,
           type: 'surface'
        }];

var layout = {
  title: 'Map of Sea Floor',
  autosize: true,
  width: 750,
  height: 750,
  margin: {
    l: 65,
    r: 50,
    b: 65,
    t: 90,
  }
};
Plotly.newPlot('myDiv', data, layout);
});
    
    </script>
  </head>

  <body>
  	<div id='myDiv'><!-- Plotly chart will be drawn inside this DIV --></div>

    <script>

google.charts.load('current');
google.charts.setOnLoadCallback(init);

function init() {

  var url =
    'https://docs.google.com/spreadsheets/d/19pvUkYDkw19fO9hlgHlSsrQgzzli8aNLkJo0A3EW51E/edit#gid=0';
  var query = new google.visualization.Query(url);
  query.setQuery('select A');
  query.send(processSheetsData);
}
	    
function processSheetsData(response) {
  var array = [];
  var data = response.getDataTable();
  var columns = data.getNumberOfColumns();
  var rows = data.getNumberOfRows();
  for (var r = 0; r < rows; r++) {
    var row = [];
    for (var c = 0; c < columns; c++) {
      row.push(data.getFormattedValue(r, c));
    }
    array.push({
      name: row[0],
      value: +row[1],
    });
  }
  // renderData(array);
  alert("Sheet Data");
  console.log("Sheet Data");
  alert(array);
  console.log(array);
}	    
    </script>	  
  </body>
</html>
